# 論文まとめフォーマット - 要件定義・設計書

## プロジェクト概要

落合陽一式の6つの質問フォーマットで論文をまとめ、画像として出力・共有できるWebアプリケーション

---

## 機能要件

### 必須要件（Must Have）

#### 1. 画像作成・出力機能
- [ ] Webページ上で論文フォーマットの画像を作成できること
- [ ] 作成した画像をダウンロードできること
- [ ] SNSへ直接投稿できること（Twitter、Facebook等）
- [ ] 複数の解像度から選択できること
  - 1080x1080（Instagram正方形）
  - 1920x1080（Twitter横長）
  - 1080x1920（Instagram縦長）

#### 2. フォーマットカスタマイズ
- [ ] 論文フォーマット上の項目名を編集できること
- [ ] 初期値は落合陽一式フォーマットに準拠
  - 1. どんなもの？
  - 2. 先行研究と比べてどこがすごいの？
  - 3. 技術や手法の"キモ"はどこにある？
  - 4. どうやって有効だと検証した？
  - 5. 議論はあるか？
  - 6. 次に読むべき論文はあるか？

#### 3. 画像アップロード機能
- [ ] 画像をコピー&ペーストで追加できること
- [ ] Webページ上にコピペ入力欄を設けること
- [ ] 論文の図表やグラフを配置できること

#### 4. リアルタイムプレビュー
- [ ] 入力内容が即座に反映されるプレビュー表示
- [ ] 文字数制限の設定と表示
- [ ] 文字数オーバー時の警告表示
- [ ] レイアウトの崩れを防ぐ自動調整

#### 5. ギャラリー機能
- [ ] 作成ページと閲覧ページを分離
- [ ] みんなが作った論文フォーマット画像を閲覧できるページ
- [ ] 最新のものから順に表示（降順ソート）
- [ ] サムネイル表示

#### 6. データ保存
- [ ] Firebase Firestoreに論文データを保存
- [ ] Firebase Storageに画像を保存
- [ ] 画像はURL経由で呼び出し

### 追加要件（Nice to Have）

#### 7. 検索・フィルタリング
- [ ] タイトルでの検索
- [ ] キーワード（分野名）での検索
- [ ] 年度でのフィルタリング

---

## 技術スタック

### フロントエンド
- **HTML5/CSS3/JavaScript（Vanilla）**
  - フレームワークなし、シンプルな構成
- **html2canvas** or **dom-to-image**
  - HTML要素を画像に変換

### バックエンド
- **Firebase**
  - Firestore Database（NoSQL）
  - Firebase Storage（画像ストレージ）
  - Firebase Hosting（オプション）

### デプロイ
- **GitHub Pages**（静的サイトホスティング）

---

## システム構成図

```
┌─────────────────────────────────────────┐
│         ユーザー（ブラウザ）              │
│                                         │
│  ┌──────────────────────────┐          │
│  │  フロントエンド            │          │
│  │  - 入力フォーム            │          │
│  │  - リアルタイムプレビュー   │          │
│  │  - 画像生成（html2canvas） │          │
│  └────────────┬─────────────┘          │
└───────────────┼─────────────────────────┘
                │
    ┌───────────┼───────────┐
    │           │           │
    ▼           ▼           ▼
┌────────┐  ┌──────────┐  ┌──────────┐
│GitHub  │  │Firebase  │  │Firebase  │
│Pages   │  │Firestore │  │Storage   │
│Hosting │  │(DB)      │  │(画像)    │
└────────┘  └──────────┘  └──────────┘
  静的HTML     論文データ     画像ファイル
```

---

## データベース設計（Firebase Firestore）

### コレクション: `papers`

```javascript
{
  id: "auto-generated-id",            // ドキュメントID
  
  // 基本情報
  title: "論文タイトル",               // string
  author: "著者名",                   // string
  year: 2024,                         // number
  date: "2024-10-26",                 // string (YYYY-MM-DD)
  
  // 分野・タグ
  categories: ["機械学習", "CV"],     // array of strings
  keywords: ["深層学習", "音声"],     // array of strings
  
  // 6つの質問（カスタマイズ可能な項目名）
  questions: {
    question1: {
      label: "どんなもの？",
      content: "映像から音を復元する技術..."
    },
    question2: {
      label: "先行研究と比べてどこがすごいの？",
      content: "レーザードップラーと比べて..."
    },
    question3: {
      label: "技術や手法の"キモ"はどこにある？",
      content: "..."
    },
    question4: {
      label: "どうやって有効だと検証した？",
      content: "..."
    },
    question5: {
      label: "議論はあるか？",
      content: "..."
    },
    question6: {
      label: "次に読むべき論文はあるか？",
      content: "..."
    }
  },
  
  // 画像URL
  imageUrl: "https://firebasestorage.googleapis.com/.../full.png",
  thumbnailUrl: "https://firebasestorage.googleapis.com/.../thumb.png",
  
  // メタデータ
  createdAt: Timestamp,               // Firebase Timestamp
  views: 0,                           // number
  resolution: "1080x1080"             // string
}
```

---

## 開発フェーズ

### Phase 1: フロントエンド基盤構築 🎯 **優先**
**データベースなしで動作するローカル版**

#### 実装内容
- [ ] プロジェクト構成・ファイル配置
- [ ] 入力フォームUI（6つの質問＋基本情報）
- [ ] 項目名の編集機能
- [ ] 画像アップロード（コピペ対応）
- [ ] リアルタイムプレビュー表示
- [ ] 文字数カウント・制限
- [ ] レスポンシブデザイン（PC/タブレット対応）

#### 成果物
- 静的HTML/CSS/JSファイル
- ローカルで動作するプレビュー機能
- ブラウザのlocalStorageでデータ保持

---

### Phase 2: 画像生成・ダウンロード機能
**html2canvasを使った画像化**

#### 実装内容
- [ ] html2canvas統合
- [ ] 画像生成機能
- [ ] 解像度選択機能（3種類）
- [ ] ダウンロード機能
- [ ] クリップボードへコピー機能

---

### Phase 3: Firebase統合
**データの永続化と共有**

#### 実装内容
- [ ] Firebaseプロジェクト作成
- [ ] Firestore Database設定
- [ ] Firebase Storage設定
- [ ] 投稿機能（画像＋データ保存）
- [ ] セキュリティルール設定

---

### Phase 4: ギャラリー機能
**みんなの投稿を見る**

#### 実装内容
- [ ] ギャラリーページ作成
- [ ] 一覧表示（最新順）
- [ ] サムネイル表示
- [ ] ページネーション
- [ ] 詳細表示モーダル

---

### Phase 5: 検索・フィルタリング
**検索機能の実装**

#### 実装内容
- [ ] タイトル検索
- [ ] カテゴリフィルタ
- [ ] 年度フィルタ
- [ ] キーワード検索（クライアント側）

---

## 文字数制限

| 項目 | 最大文字数 |
|---|---|
| タイトル | 50文字 |
| 著者名 | 100文字 |
| 各質問の回答 | 300文字 |
| カテゴリ | 1つ20文字、最大5個 |

---

## デザイン要件

- 落合陽一式のビジュアルデザインを参考
- 上部に画像・グラフ配置エリア
- カード型レイアウト（6つの質問）
- シンプルな配色（白背景、黒文字）
- アクセントカラー（青系統）

---

## 非機能要件

### パフォーマンス
- ページ読み込み: 3秒以内
- プレビュー更新: リアルタイム（遅延なし）
- 画像生成: 5秒以内

### セキュリティ
- XSS対策（入力のサニタイズ）
- Firebase Security Rules設定
- 画像サイズ制限（5MB以下）

### 互換性
- モダンブラウザ対応（Chrome、Firefox、Safari、Edge）
- スマホでの閲覧対応（投稿はPC推奨）

---

## コスト試算（Firebase無料枠）

```
想定: 月100投稿、1000PV

Firestore:
- 読み取り: 1000 PV × 20件 = 20,000読み取り/月
- 無料枠: 50,000読み取り/日 = 1,500,000読み取り/月
→ 余裕で無料枠内

Storage:
- 100投稿 × 500KB = 50MB
- 無料枠: 5GB
→ 無料枠内

合計: 完全無料で運用可能
```

---

## リスクと対策

| リスク | 影響 | 対策 |
|---|---|---|
| スパム投稿 | データ汚染 | reCAPTCHA導入（Phase 6） |
| 不適切な画像 | 品質低下 | 報告機能（Phase 6） |
| Firebase無料枠超過 | コスト発生 | 使用量監視、アラート設定 |
| 画像生成の品質 | UX低下 | html2canvasの設定最適化 |